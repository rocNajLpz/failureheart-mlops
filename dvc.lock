schema: '2.0'
stages:
  data_prepare:
    cmd: python -m src.stages.data_prepare --config=params.yaml
    deps:
    - path: src/stages/data_prepare.py
      hash: md5
      md5: 38f7d959eef28931672472d5ed4f3faf
      size: 987
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/raw/dataset.csv
          dataset_prepare: data/processed/prepare_dataset.csv
    outs:
    - path: data/processed/prepare_dataset.csv
      hash: md5
      md5: 3518e02af18217521d0d90a9e3ff7745
      size: 13493
  featurize:
    cmd: python -m src.stages.featurize --config=params.yaml
    deps:
    - path: data/processed/prepare_dataset.csv
      hash: md5
      md5: 3518e02af18217521d0d90a9e3ff7745
      size: 13493
    - path: src/stages/featurize.py
      hash: md5
      md5: c7e75beee18d1ccf9ee5e683d54c9dee
      size: 1865
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/raw/dataset.csv
          dataset_prepare: data/processed/prepare_dataset.csv
        featurize:
          features_path: data/processed/featured_dataset.csv
          target_column: DEATH_EVENT
          categorical_features:
          - DEATH_EVENT
          cols_to_drop:
          - smoking
          - sex
    outs:
    - path: data/processed/featured_dataset.csv
      hash: md5
      md5: 082246e2f624938c2a397a3f22823c2c
      size: 12285
  data_split:
    cmd: python -m src.stages.data_split --config=params.yaml
    deps:
    - path: data/processed/featured_dataset.csv
      hash: md5
      md5: 082246e2f624938c2a397a3f22823c2c
      size: 12285
    - path: src/stages/data_split.py
      hash: md5
      md5: 8dfe312ff90160af2ff57f15ac8cb829
      size: 1298
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_load:
          dataset_csv: data/raw/dataset.csv
          dataset_prepare: data/processed/prepare_dataset.csv
        data_split:
          test_size: 0.2
          trainset_path: data/processed/train_dataset.csv
          testset_path: data/processed/test_dataset.csv
          target_column: DEATH_EVENT
        featurize:
          features_path: data/processed/featured_dataset.csv
          target_column: DEATH_EVENT
          categorical_features:
          - DEATH_EVENT
          cols_to_drop:
          - smoking
          - sex
    outs:
    - path: data/processed/test_dataset.csv
      hash: md5
      md5: 6532f82640d4823d2e0a2697566401f9
      size: 2574
    - path: data/processed/train_dataset.csv
      hash: md5
      md5: 00163fd104f15c52ab4ce8b65597055f
      size: 9852
  train:
    cmd: python -m src.stages.train --config=params.yaml
    deps:
    - path: data/processed/train_dataset.csv
      hash: md5
      md5: 00163fd104f15c52ab4ce8b65597055f
      size: 9852
    - path: src/stages/train.py
      hash: md5
      md5: 636df6971b528a68f9e08d9d541e3afe
      size: 1765
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_split.trainset_path: data/processed/train_dataset.csv
        featurize.target_column: DEATH_EVENT
        train:
          cv: 3
          estimator_name: rdm_forest
          estimators:
            logreg:
              param_grid:
                C:
                - 0.005
                max_iter:
                - 100
                solver:
                - lbfgs
                multi_class:
                - multinomial
            svm:
              param_grid:
                C:
                - 0.1
                - 1.0
                kernel:
                - rbf
                - linear
                gamma:
                - scale
                degree:
                - 3
                - 5
            rdm_forest:
              param_grid:
          model_path: models/model.joblib
    outs:
    - path: models/model.joblib
      hash: md5
      md5: ebb9c257cb5264214e7960f62b0cf80a
      size: 500345
  evaluate:
    cmd: python -m src.stages.evaluate --config=params.yaml
    deps:
    - path: data/processed/test_dataset.csv
      hash: md5
      md5: 6532f82640d4823d2e0a2697566401f9
      size: 2574
    - path: models/model.joblib
      hash: md5
      md5: ebb9c257cb5264214e7960f62b0cf80a
      size: 500345
    - path: src/stages/evaluate.py
      hash: md5
      md5: 2296ceb7ae340454f5b6e2416cb1f217
      size: 2038
    params:
      params.yaml:
        base:
          random_state: 42
          log_level: INFO
        data_split.testset_path: data/processed/test_dataset.csv
        evaluate:
          reports_dir: reports
          metrics_file: metrics.json
          confusion_matrix_image: confusion_matrix.png
        featurize.target_column: DEATH_EVENT
    outs:
    - path: reports/metrics.json
      hash: md5
      md5: 0de937ebc6615b958d88a71d66dee912
      size: 32
